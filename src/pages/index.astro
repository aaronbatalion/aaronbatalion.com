---
import BaseLayout from '../layouts/BaseLayout.astro';
import Header from '../components/Header.astro';
import PlatformIcon from '../components/PlatformIcon.astro';
import linksData from '../../data/links.json';

const posts = linksData.sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime());

function formatDate(dateStr: string): string {
  const date = new Date(dateStr);
  return date.toLocaleDateString('en-US', { month: 'short', year: 'numeric' });
}

function formatDateISO(dateStr: string): string {
  return new Date(dateStr).toISOString().split('T')[0];
}

function getPlatform(url: string): string {
  if (!url) return 'Web';
  if (url.includes('medium.com')) return 'Medium';
  if (url.includes('x.com') || url.includes('twitter.com')) return 'X';
  if (url.includes('linkedin.com')) return 'LinkedIn';
  if (url.includes('threads.net') || url.includes('threads.com')) return 'Threads';
  return 'Web';
}
---

<BaseLayout title="Hi! I'm Aaron Batalion!">
  <Header />

  <section class="main">
    <div class="container">
      <div class="content">
        <ul>
          {posts.map((post) => (
            <li class="post-item">
              <span class="meta">
                <time datetime={formatDateISO(post.date)}>{formatDate(post.date)}</time>
              </span>
              <span class="icon-container" style="margin-right: 10px; display: inline-flex; align-items: center; color: #666; padding-top: 3px;">
                 <PlatformIcon platform={getPlatform(post.url)} />
              </span>
              <span class="post-link">
                <a target="_blank" rel="noopener" href={post.url}>
                  <span>{post.title}</span>
                </a>
              </span>
            </li>
          ))}
        </ul>
      </div>
    </div>
  </section>
</BaseLayout>
